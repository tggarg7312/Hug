<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Moment</title>
    <style>
        /* --- DESIGN RULES & COLOR PSYCHOLOGY --- */
        :root {
            --peach: #FAD6C4;
            --dusk-pink: #E8B4B8;
            --amber-glow: #D48C70;
            --text-warm: #4A332A;
            --hold-progress: 0; /* JS controls this from 0 to 1 */
        }

        /* Reset & Mobile Optimization */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body, html {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(135deg, var(--peach), var(--dusk-pink));
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-warm);
            touch-action: none; /* Prevents pull-to-refresh & scrolling */
            user-select: none;
            -webkit-user-select: none;
        }

        /* SVG Noise Filter for Fabric/Organic Texture */
        .texture-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            opacity: 0.15;
            z-index: 100;
            background: url('data:image/svg+xml;utf8,%3Csvg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"%3E%3Cfilter id="noiseFilter"%3E%3CfeTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="3" stitchTiles="stitch"/%3E%3C/filter%3E%3Crect width="100%25" height="100%25" filter="url(%23noiseFilter)"/%3E%3C/svg%3E');
        }

        /* Cinematic Stages Container */
        .stage {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 2s ease-in-out;
            padding: 2rem;
            text-align: center;
        }
        .stage.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Typography */
        h1, p { font-weight: 300; letter-spacing: 0.5px; line-height: 1.6; }
        .small-text { font-size: 0.9rem; opacity: 0.8; }
        .reading-text { font-size: 1.1rem; max-width: 320px; }

        /* Specific Stage Elements */
        #text-come-closer, #text-closer { opacity: 0; transition: opacity 2s ease-in-out; }
        
        /* The Silhouette & Hold Interaction */
        .silhouette {
            width: 250px;
            height: 350px;
            background: radial-gradient(ellipse at center, var(--amber-glow) 0%, transparent 70%);
            border-radius: 50%;
            /* Blur reduces and size increases based on hold progress */
            filter: blur(calc(30px - (var(--hold-progress) * 20px)));
            transform: scale(calc(1 + (var(--hold-progress) * 0.3)));
            margin-bottom: 2rem;
            transition: filter 0.1s, transform 0.1s;
        }
        
        #press-area {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10;
        }

        /* The POV Hug - Swaying & Breathing */
        @keyframes sway {
            0% { transform: translate(0px, 0px) rotate(0deg); }
            25% { transform: translate(2px, 2px) rotate(0.5deg); }
            50% { transform: translate(0px, 4px) rotate(0deg); }
            75% { transform: translate(-2px, 2px) rotate(-0.5deg); }
            100% { transform: translate(0px, 0px) rotate(0deg); }
        }
        .hug-active .texture-overlay { opacity: 0.25; transition: opacity 3s ease; }
        .hug-active body { background: linear-gradient(135deg, var(--amber-glow), var(--dusk-pink)); transition: background 4s ease; }
        .sway-container { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; animation: sway 6s infinite ease-in-out; }

        /* Breathing Circle */
        .breath-circle {
            width: 100px;
            height: 100px;
            border: 1px solid var(--text-warm);
            border-radius: 50%;
            opacity: 0.3;
            transition: transform 4s ease-in-out;
        }
        .inhale .breath-circle { transform: scale(2.5); }
        .exhale .breath-circle { transform: scale(1); }

        /* Audio Control */
        #audio-btn {
            position: fixed;
            top: 20px; right: 20px;
            z-index: 1000;
            background: none; border: none;
            color: var(--text-warm);
            opacity: 0.5; font-size: 0.8rem;
            padding: 10px; cursor: pointer;
        }

        /* Final Dimming */
        .dimmed { background: #1a1210 !important; transition: background 5s ease !important; }
        .dimmed .texture-overlay { opacity: 0.05; }
        .dimmed p { color: var(--amber-glow); }
    </style>
</head>
<body>

    <div class="texture-overlay"></div>
    <button id="audio-btn">Mute</button>

    <audio id="audio-ambient" loop src="ambient-pad.mp3"></audio>
    <audio id="audio-heartbeat" loop src="heartbeat.mp3"></audio>

    <div id="stage-opening" class="stage active">
        <p id="text-come-closer" class="small-text">Come closer...</p>
        <p id="text-closer" class="small-text" style="margin-top: 2rem;">Closer.</p>
    </div>

    <div id="stage-press" class="stage">
        <div id="press-area"></div>
        <div class="silhouette"></div>
        <p class="small-text">Press and hold… to step into my arms.</p>
    </div>

    <div id="stage-hug" class="stage">
        <div class="sway-container">
            <p id="hug-text" class="reading-text"></p>
        </div>
    </div>

    <div id="stage-breathe" class="stage">
        <div class="sway-container">
            <div class="breath-circle"></div>
            <p id="breathe-text" class="small-text" style="margin-top: 2rem;">Breathe with me.</p>
        </div>
    </div>

    <div id="stage-message" class="stage">
        <div class="sway-container">
            <p class="reading-text" style="text-align: left;">
                <span id="msg-1" style="opacity: 0; transition: opacity 2s;">In a world that moves too fast…<br>I want to be the place where you can pause.<br><br></span>
                <span id="msg-2" style="opacity: 0; transition: opacity 2s;">When days are heavy — come here.<br>When nights feel long — come here.<br><br></span>
                <span id="msg-3" style="opacity: 0; transition: opacity 2s;">You will always have a space in my arms<br>where nothing is demanded from you…<br>and everything about you is welcome.</span>
            </p>
        </div>
    </div>

    <div id="stage-final" class="stage">
        <p id="final-text-1" class="reading-text" style="opacity: 0; transition: opacity 3s;">Whenever life feels overwhelming…</p>
        <p id="final-text-2" class="reading-text" style="opacity: 0; transition: opacity 3s; margin-top: 1rem;">Remember this hug exists.</p>
        <p id="final-text-3" class="reading-text" style="opacity: 0; transition: opacity 4s; margin-top: 3rem;">And so do I.</p>
    </div>

    <script>
        // --- CINEMATIC TIMELINE TOOLKIT ---
        const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));
        const fadeText = (id, opacity) => document.getElementById(id).style.opacity = opacity;
        const switchStage = (hideId, showId) => {
            document.getElementById(hideId).classList.remove('active');
            document.getElementById(showId).classList.active = true;
            setTimeout(() => document.getElementById(showId).classList.add('active'), 100);
        };

        // --- AUDIO MANAGEMENT ---
        const ambientAudio = document.getElementById('audio-ambient');
        const heartbeatAudio = document.getElementById('audio-heartbeat');
        let audioUnlocked = false;
        ambientAudio.volume = 0.2;
        heartbeatAudio.volume = 0.0;

        document.getElementById('audio-btn').addEventListener('click', () => {
            if(ambientAudio.muted) {
                ambientAudio.muted = false;
                heartbeatAudio.muted = false;
                document.getElementById('audio-btn').innerText = "Mute";
            } else {
                ambientAudio.muted = true;
                heartbeatAudio.muted = true;
                document.getElementById('audio-btn').innerText = "Unmute";
            }
        });

        // Unlock audio on first touch
        const unlockAudio = () => {
            if(!audioUnlocked) {
                ambientAudio.play().catch(e => console.log("Audio requires user gesture"));
                heartbeatAudio.play().catch(e => console.log("Audio requires user gesture"));
                audioUnlocked = true;
            }
        };

        // --- STAGE 1 LOGIC ---
        window.onload = async () => {
            await sleep(2000);
            fadeText('text-come-closer', 1);
            await sleep(2500);
            fadeText('text-closer', 1);
        };

        // Advance to Stage 2 on Tap
        document.getElementById('stage-opening').addEventListener('click', async () => {
            unlockAudio();
            switchStage('stage-opening', 'stage-press');
        });

        // --- STAGE 2 LOGIC: THE PRESS & HOLD ---
        const pressArea = document.getElementById('press-area');
        let isHolding = false;
        let holdProgress = 0;
        let holdFrame;

        const updateHold = () => {
            if (isHolding && holdProgress < 1) {
                holdProgress += 0.008; // Adjust for speed (~2.5 seconds to full)
                document.documentElement.style.setProperty('--hold-progress', holdProgress);
                heartbeatAudio.volume = holdProgress * 0.4; // Fade in heartbeat
                holdFrame = requestAnimationFrame(updateHold);
            } else if (!isHolding && holdProgress > 0) {
                holdProgress -= 0.02; // Snap back faster if released
                document.documentElement.style.setProperty('--hold-progress', Math.max(0, holdProgress));
                heartbeatAudio.volume = Math.max(0, holdProgress * 0.4);
                holdFrame = requestAnimationFrame(updateHold);
            } else if (holdProgress >= 1) {
                // HOLD COMPLETE - Trigger Hug
                isHolding = false;
                triggerHugSequence();
            }
        };

        const startHold = (e) => { e.preventDefault(); isHolding = true; updateHold(); };
        const endHold = (e) => { e.preventDefault(); isHolding = false; };

        pressArea.addEventListener('mousedown', startHold);
        pressArea.addEventListener('touchstart', startHold);
        window.addEventListener('mouseup', endHold);
        window.addEventListener('touchend', endHold);

        // --- MASTER CINEMATIC SEQUENCE ---
        async function triggerHugSequence() {
            // Disable press area
            pressArea.style.pointerEvents = 'none';
            document.body.classList.add('hug-active');
            
            switchStage('stage-press', 'stage-hug');
            const hugText = document.getElementById('hug-text');

            // The Hug Messages
            await sleep(2000);
            hugText.style.opacity = 0; hugText.innerText = "You don't have to be strong right now.";
            hugText.style.transition = "opacity 2s"; 
            setTimeout(() => hugText.style.opacity = 1, 100);
            
            await sleep(4000);
            hugText.style.opacity = 0;
            await sleep(2000);
            hugText.innerText = "I've got you.";
            hugText.style.opacity = 1;

            await sleep(4000);
            hugText.style.opacity = 0;
            await sleep(2000);
            hugText.innerText = "Just stay here for a moment.";
            hugText.style.opacity = 1;

            await sleep(5000);
            
            // The Breath Sync
            switchStage('stage-hug', 'stage-breathe');
            const breatheStage = document.getElementById('stage-breathe');
            const breatheText = document.getElementById('breathe-text');
            
            await sleep(2000);
            for(let i=0; i<3; i++) {
                breatheText.innerText = "Inhale...";
                breatheStage.classList.remove('exhale');
                breatheStage.classList.add('inhale');
                await sleep(4000);
                
                breatheText.innerText = "Exhale...";
                breatheStage.classList.remove('inhale');
                breatheStage.classList.add('exhale');
                await sleep(5000); // Exhale slightly longer
            }

            // The Message
            switchStage('stage-breathe', 'stage-message');
            await sleep(1500);
            fadeText('msg-1', 1);
            await sleep(3500);
            fadeText('msg-2', 1);
            await sleep(3500);
            fadeText('msg-3', 1);
            
            await sleep(7000);

            // The Final Moment
            switchStage('stage-message', 'stage-final');
            await sleep(2000);
            fadeText('final-text-1', 1);
            
            await sleep(3000);
            fadeText('final-text-2', 1);

            await sleep(4000);
            // Dimming effect
            document.body.classList.add('dimmed');
            
            // Fade out heartbeat slowly
            let fadeOut = setInterval(() => {
                if(heartbeatAudio.volume > 0.02) heartbeatAudio.volume -= 0.02;
                else { heartbeatAudio.volume = 0; clearInterval(fadeOut); }
            }, 200);

            await sleep(3000);
            fadeText('final-text-3', 1);
            // End of sequence. User sits in the ambient audio and dim screen.
        }
    </script>
</body>
</html>
