<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Forever Ours</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:ital,wght@1,600&display=swap" rel="stylesheet">
    
    <style>
        /* --- RECALIBRATED ROMANTIC COLOR PSYCHOLOGY --- */
        :root {
            --peach: #FCE4EC;      /* Soft Rosewater */
            --dusk-pink: #F48FB1;  /* Deeper Blush Pink */
            --amber-glow: #D81B60; /* Deep Warm Magenta/Rose */
            --text-warm: #4A148C;  /* Very Dark Purple/Pink for high contrast */
            --hold-progress: 0;
        }

        /* Reset & Mobile Optimization */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body, html {
            width: 100vw; height: 100vh; overflow: hidden;
            background: linear-gradient(135deg, var(--peach), var(--dusk-pink));
            color: var(--text-warm);
            touch-action: none; user-select: none; -webkit-user-select: none;
            /* CRITICAL FIX FOR IOS / IN-APP BROWSERS */
            cursor: pointer; -webkit-tap-highlight-color: transparent;
        }

        /* The Elegant Typography */
        p, span { 
            font-family: 'Playfair Display', serif; 
            font-style: italic; 
            font-weight: 600; 
            letter-spacing: 0.5px; 
            line-height: 1.6; 
        }
        .small-text { font-size: 1.1rem; opacity: 0.85; }
        .reading-text { font-size: 1.3rem; max-width: 320px; z-index: 10; position: relative; }
        
        /* The ultra-cursive highlight font */
        .cursive-highlight {
            font-family: 'Great Vibes', cursive;
            font-size: 2.5rem;
            font-weight: normal;
            display: block;
            margin-top: 10px;
            color: var(--amber-glow);
        }

        /* SVG Noise Filter for Fabric Texture */
        .texture-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; opacity: 0.15; z-index: 100;
            background: url('data:image/svg+xml;utf8,%3Csvg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"%3E%3Cfilter id="noiseFilter"%3E%3CfeTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="3" stitchTiles="stitch"/%3E%3C/filter%3E%3Crect width="100%25" height="100%25" filter="url(%23noiseFilter)"/%3E%3C/svg%3E');
        }

        /* Cinematic Stages Container */
        .stage {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 1.5s ease-in-out;
            padding: 2rem; text-align: center; z-index: 1;
        }
        .stage.active { opacity: 1; pointer-events: auto; z-index: 2; }

        /* Slow Butterfly Animations */
        #butterfly-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; overflow: hidden; z-index: 0; }
        .butterfly {
            position: absolute; bottom: -50px; width: 30px; height: 30px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23D81B60" opacity="0.6"><path d="M12 22s-4-2.5-4-7c0-2.5 2-4 4-4s4 1.5 4 4c0 4.5-4 7-4 7zm0-15c-3-3-8-4-10-1 0 0 2.5 5 10 9 7.5-4 10-9 10-9-2-3-7-2-10 1z"/></svg>');
            background-size: contain; background-repeat: no-repeat; opacity: 0;
            animation: floatUp 8s ease-in-out forwards, flutter 2s infinite alternate ease-in-out;
            pointer-events: none;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            20% { opacity: 0.8; }
            100% { transform: translateY(-100vh) scale(1.2); opacity: 0; }
        }
        @keyframes flutter {
            0% { margin-left: -20px; }
            100% { margin-left: 20px; }
        }

        /* Opening Text & Tap Prompt */
        #text-come-closer, #text-closer, #text-tap { opacity: 0; transition: opacity 2s ease-in-out; }
        @keyframes subtlePulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.7; } }
        #text-tap { font-size: 0.85rem; margin-top: 4rem; animation: subtlePulse 3s infinite ease-in-out; font-family: -apple-system, sans-serif; font-style: normal; }

        /* The Silhouette Image (Hold Interaction) */
        .silhouette-container { margin-bottom: 2rem; pointer-events: none; }
        .silhouette-container img {
            width: 220px; height: 320px; object-fit: cover; border-radius: 50%;
            filter: blur(calc(25px - (var(--hold-progress) * 20px))) brightness(calc(1 + var(--hold-progress) * 0.15));
            transform: scale(calc(1 + (var(--hold-progress) * 0.35)));
            opacity: calc(0.6 + (var(--hold-progress) * 0.4));
            transition: filter 0.1s linear, transform 0.1s linear, opacity 0.1s linear;
            box-shadow: 0 0 calc(var(--hold-progress) * 50px) var(--amber-glow);
        }
        #press-area { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; cursor: pointer; }

        /* Swaying POV */
        @keyframes sway {
            0% { transform: translate(0px, 0px) rotate(0deg); }
            25% { transform: translate(1px, 2px) rotate(0.3deg); }
            50% { transform: translate(0px, 3px) rotate(0deg); }
            75% { transform: translate(-1px, 2px) rotate(-0.3deg); }
            100% { transform: translate(0px, 0px) rotate(0deg); }
        }
        .hug-active .texture-overlay { opacity: 0.25; transition: opacity 3s ease; }
        .hug-active { background: linear-gradient(135deg, var(--amber-glow), var(--dusk-pink)) !important; transition: background 4s ease; }
        .sway-container { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; animation: sway 7s infinite ease-in-out; }

        /* Breathing Circle */
        .breath-circle {
            width: 80px; height: 80px;
            border: 2px solid var(--text-warm); border-radius: 50%; opacity: 0.4;
            transition: transform 4s ease-in-out, opacity 4s ease;
        }
        .inhale .breath-circle { transform: scale(3.5); opacity: 0.1; }
        .exhale .breath-circle { transform: scale(1); opacity: 0.4; }

        /* --- FINAL STAGE: PHOTO COLLAGE --- */
        .photo-collage {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0;
        }
        .polaroid {
            position: absolute; width: 140px; height: 160px;
            background: white; padding: 10px 10px 30px 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); border-radius: 4px;
            opacity: 0; transition: opacity 4s ease; object-fit: cover;
        }
        
        /* Positioning the 3 photos around the edges */
        #photo1 { top: 10%; left: 5%; transform: rotate(-12deg); }
        #photo2 { top: 65%; left: 8%; transform: rotate(10deg); }
        #photo3 { top: 25%; right: 5%; transform: rotate(15deg); }

        #final-text-container { z-index: 5; position: relative; text-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .dimmed { background: #2a0a18 !important; transition: background 6s ease !important; }
        .dimmed .texture-overlay { opacity: 0.05; }
        .dimmed p { color: #FCE4EC; }
        .dimmed .cursive-highlight { color: #F48FB1; text-shadow: 0 0 15px rgba(216, 27, 96, 0.5); }
    </style>
</head>
<body>

    <audio id="bg-music" loop src="music.mp3"></audio>

    <div class="texture-overlay"></div>
    <div id="butterfly-container"></div>

    <div id="stage-opening" class="stage active">
        <p id="text-come-closer" class="small-text">Come closer...</p>
        <p id="text-closer" class="small-text" style="margin-top: 2rem;">Closer.</p>
        <p id="text-tap">(tap anywhere)</p>
    </div>

    <div id="stage-press" class="stage">
        <div id="press-area"></div>
        <div class="silhouette-container">
            <img src="https://images.unsplash.com/photo-1518144591331-17a5dd71c477?q=80&w=600&auto=format&fit=crop" alt="Presence">
        </div>
        <p class="small-text">Press and hold… to step into my arms.</p>
    </div>

    <div id="stage-hug" class="stage">
        <div class="sway-container">
            <p id="hug-text" class="reading-text"></p>
        </div>
    </div>

    <div id="stage-breathe" class="stage">
        <div class="sway-container">
            <div class="breath-circle"></div>
            <p id="breathe-text" class="small-text" style="margin-top: 2rem;">Breathe with me.</p>
        </div>
    </div>

    <div id="stage-message" class="stage">
        <div class="sway-container">
            <p class="reading-text" style="text-align: left;">
                <span id="msg-1" style="opacity: 0; transition: opacity 2.5s;">In a world that moves too fast…<br>I want to be the place where you can pause.<br><br></span>
                <span id="msg-2" style="opacity: 0; transition: opacity 2.5s;">When days are heavy — come here.<br>When nights feel long — come here.<br><br></span>
                <span id="msg-3" style="opacity: 0; transition: opacity 3s;">You will always have a space in my arms<br>where nothing is demanded from you…<br>and everything about you is welcome.</span>
            </p>
        </div>
    </div>

    <div id="stage-final" class="stage">
        <div class="photo-collage">
            <img id="photo1" class="polaroid" src="photo1.jpg" alt="Us 1">
            <img id="photo2" class="polaroid" src="photo2.jpg" alt="Us 2">
            <img id="photo3" class="polaroid" src="photo3.jpg" alt="Us 3">
        </div>
        <div id="final-text-container">
            <p id="final-text-1" class="reading-text" style="opacity: 0; transition: opacity 3s;">Whenever life feels overwhelming…</p>
            <p id="final-text-2" class="reading-text" style="opacity: 0; transition: opacity 3s; margin-top: 1rem;">Remember this hug exists.</p>
            <p id="final-text-3" class="reading-text" style="opacity: 0; transition: opacity 4s; margin-top: 3rem;">
                <span class="cursive-highlight">Our Hugs will be<br>Forever Ours</span>
            </p>
        </div>
    </div>

    <script>
        // --- TIMELINE TOOLKIT ---
        const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));
        const fadeText = (id, opacity) => { document.getElementById(id).style.opacity = opacity; };
        const switchStage = (hideId, showId) => {
            document.getElementById(hideId).classList.remove('active');
            setTimeout(() => { document.getElementById(showId).classList.add('active'); }, 50); 
        };

        // --- BUTTERFLY SPAWNER ---
        function spawnButterflies() {
            const container = document.getElementById('butterfly-container');
            let count = 0;
            const interval = setInterval(() => {
                if (count > 6) { clearInterval(interval); return; } // Max 7 butterflies for elegance
                const butterfly = document.createElement('div');
                butterfly.classList.add('butterfly');
                butterfly.style.left = Math.random() * 80 + 10 + 'vw';
                butterfly.style.animationDuration = (Math.random() * 4 + 6) + 's, 2s'; 
                container.appendChild(butterfly);
                setTimeout(() => butterfly.remove(), 10000); 
                count++;
            }, 1500);
        }

        // --- STAGE 1: FORCED OPENING ---
        setTimeout(async () => {
            spawnButterflies(); 
            await sleep(800);
            fadeText('text-come-closer', 1);
            await sleep(2000);
            fadeText('text-closer', 1);
            await sleep(1500);
            fadeText('text-tap', 1); 
        }, 100);

        let hasStarted = false;
        const bgMusic = document.getElementById('bg-music');

        const startExperience = () => {
            if (!hasStarted) {
                hasStarted = true;
                // UNLOCK AUDIO ON FIRST TOUCH
                bgMusic.play().catch(err => console.log("Audio waiting for stronger interaction:", err));
                switchStage('stage-opening', 'stage-press');
            }
        };

        document.documentElement.addEventListener('click', startExperience);
        document.documentElement.addEventListener('touchstart', startExperience, { passive: true });

        // --- STAGE 2 LOGIC: THE PRESS & HOLD ---
        const pressArea = document.getElementById('press-area');
        let isHolding = false; let holdProgress = 0; let holdFrame; let hasHugTriggered = false;

        const updateHold = () => {
            if (hasHugTriggered) return;
            if (isHolding && holdProgress < 1) {
                holdProgress += 0.007; // ~2.5 seconds to fill
                document.documentElement.style.setProperty('--hold-progress', holdProgress);
                holdFrame = requestAnimationFrame(updateHold);
            } else if (!isHolding && holdProgress > 0) {
                holdProgress -= 0.02; // shrink slightly faster on release
                document.documentElement.style.setProperty('--hold-progress', Math.max(0, holdProgress));
                holdFrame = requestAnimationFrame(updateHold);
            } else if (holdProgress >= 1 && isHolding) {
                hasHugTriggered = true;
                triggerHugSequence();
            }
        };

        const startHold = (e) => { 
            if (e.cancelable) e.preventDefault(); 
            if (hasHugTriggered) return;
            isHolding = true; cancelAnimationFrame(holdFrame); updateHold(); 
        };
        const endHold = (e) => { 
            if (e.cancelable) e.preventDefault(); 
            isHolding = false; cancelAnimationFrame(holdFrame); updateHold(); 
        };

        pressArea.addEventListener('mousedown', startHold);
        pressArea.addEventListener('touchstart', startHold, {passive: false});
        window.addEventListener('mouseup', endHold);
        window.addEventListener('touchend', endHold);

        // --- MASTER CINEMATIC SEQUENCE ---
        async function triggerHugSequence() {
            pressArea.style.pointerEvents = 'none'; 
            document.body.classList.add('hug-active'); 
            
            switchStage('stage-press', 'stage-hug');
            const hugText = document.getElementById('hug-text');

            await sleep(2500);
            hugText.style.opacity = 0; hugText.innerText = "You don't have to be strong right now."; hugText.style.transition = "opacity 2.5s"; 
            setTimeout(() => hugText.style.opacity = 1, 50);
            
            await sleep(4500);
            hugText.style.opacity = 0; await sleep(2500);
            hugText.innerText = "I've got you."; hugText.style.opacity = 1;

            await sleep(4000);
            hugText.style.opacity = 0; await sleep(2500);
            hugText.innerText = "Just stay here for a moment."; hugText.style.opacity = 1;

            await sleep(5500);
            
            switchStage('stage-hug', 'stage-breathe');
            const breatheStage = document.getElementById('stage-breathe');
            const breatheText = document.getElementById('breathe-text');
            
            await sleep(2500);
            for(let i=0; i<3; i++) {
                breatheText.innerText = "Inhale..."; breatheStage.classList.remove('exhale'); breatheStage.classList.add('inhale');
                await sleep(4000);
                breatheText.innerText = "Exhale..."; breatheStage.classList.remove('inhale'); breatheStage.classList.add('exhale');
                await sleep(5000); 
            }

            switchStage('stage-breathe', 'stage-message');
            await sleep(2000); fadeText('msg-1', 1);
            await sleep(4000); fadeText('msg-2', 1);
            await sleep(4000); fadeText('msg-3', 1);
            
            await sleep(8000);

            switchStage('stage-message', 'stage-final');
            await sleep(2500); fadeText('final-text-1', 1);
            await sleep(3500); fadeText('final-text-2', 1);

            await sleep(4500);
            document.body.classList.add('dimmed'); 

            // Reveal the Photos slowly in the background
            setTimeout(() => fadeText('photo1', 0.6), 1000);
            setTimeout(() => fadeText('photo2', 0.6), 2500);
            setTimeout(() => fadeText('photo3', 0.6), 4000);
            
            await sleep(3500);
            fadeText('final-text-3', 1);
        }
    </script>
</body>
</html>
